<html class="h-full bg-white">
    <head>
        <div th:replace="~{fragments/head}"></div>
        <style>
          .inline-content div {
            display: inline;
          }
          .inline-content {
            display: inline;
          }
          .inline-content > div {
            display: inline;
          }
          
        </style>
    </head>
    <body class="h-full" x-data="{ isSidebarOpen: false }">
      <div>
        <div th:replace="~{fragments/sidebar}"></div>

      
        <main class="py-10 lg:pl-72">
          <div class="px-4 sm:px-6 lg:px-8">
            <div>
              <div class="lg:flex lg:items-center lg:justify-between">
                <div class="min-w-0 flex-1">
                  <h2 th:text="${channel.name}" class="text-2xl font-bold leading-7 text-gray-900 sm:truncate sm:text-3xl sm:tracking-tight">
                    Channel name
                  </h2>
                  <div class="mt-1 flex flex-col sm:mt-0 sm:flex-row sm:flex-wrap sm:space-x-6">
                    <div class="mt-2 flex items-center text-gray-500">
                      <span th:text="${channel.privacy}">Public</span>
                        <span class="ml-1 mr-1">&#183;</span>
                      <span>Closed threads are hidden</span>
                      <span th:if="${channel.description}" class="ml-1 mr-1">&#183;</span>
                      <span th:text="${channel.description}"></span>
                    </div>
                  </div>
                </div>
                <div class="mt-5 flex lg:ml-4 lg:mt-0">
                  
                  <div class="flex -space-x-2 overflow-hidden">
                    
                    <img th:each="member: ${workspace.memberships}" class="inline-block h-10 w-10 rounded-full ring-2 ring-white" 
                    th:src="${'https://api.dicebear.com/9.x/initials/svg?seed=' + member.user.firstName + ' ' + member.user.lastName}" th:alt="${member.user.firstName + ' ' + member.user.lastName}">

                  </div>
              
                  <span class="sm:ml-3">
                    <a th:href="@{/w/{workspaceId}/c/{channelId}/compose(workspaceId=${workspace.id}, channelId=${channel.id})}" type="button" class="inline-flex items-center rounded-md bg-cyan-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-cyan-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">

                      <svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 mr-1.5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
                      </svg>
                      New thread
                    </a>
                  </span>

                  <div th:if="${isAdmin == true}" class="mt-4 flex items-center justify-between sm:ml-6 sm:mt-0 sm:flex-shrink-0 sm:justify-start" 
                  x-data="{open: false}">
                    <!-- <span class="inline-flex items-center rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-inset ring-green-600/20">Open</span> -->
                    <div class="relative ml-3 inline-block text-left">
                      <div>
                        <button x-on:click="open = !open"  type="button" class="-my-2 flex items-center rounded-full bg-white p-2 text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-indigo-500" id="menu-0-button" aria-expanded="false" aria-haspopup="true">
                          <span class="sr-only">Open options</span>
                          <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                            <path d="M10 3a1.5 1.5 0 110 3 1.5 1.5 0 010-3zM10 8.5a1.5 1.5 0 110 3 1.5 1.5 0 010-3zM11.5 15.5a1.5 1.5 0 10-3 0 1.5 1.5 0 003 0z" />
                          </svg>
                        </button>
                      </div>
              
                      <!--
                        Dropdown menu, show/hide based on menu state.
              
                        Entering: "transition ease-out duration-100"
                          From: "transform opacity-0 scale-95"
                          To: "transform opacity-100 scale-100"
                        Leaving: "transition ease-in duration-75"
                          From: "transform opacity-100 scale-100"
                          To: "transform opacity-0 scale-95"
                      -->
                      <div class="absolute right-1 z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none" role="menu" aria-orientation="vertical" aria-labelledby="menu-0-button" tabindex="-1"
                      x-show="open" @click.outside="open = false">
                        <div class="py-1" role="none">
                          <!-- Active: "bg-gray-100 text-gray-900", Not Active: "text-gray-700" -->
                          <!-- <a href="#" class="flex justify-between px-4 py-2 text-sm text-gray-700" role="menuitem" tabindex="-1" id="menu-0-item-0">
                            <span>Edit</span>
                          </a> -->
                          <!-- <a href="#" class="flex justify-between px-4 py-2 text-sm text-gray-700" role="menuitem" tabindex="-1" id="menu-0-item-1">
                            <span>Duplicate</span>
                          </a> -->
                          <!-- <button type="button" class="flex w-full justify-between px-4 py-2 text-sm text-gray-700" role="menuitem" tabindex="-1" id="menu-0-item-2">
                            <span>Archive</span>
                          </button> -->
                          <a th:href="@{/w/{workspaceId}/c/{channelId}/edit(workspaceId=${workspace.id}, channelId=${channel.id})}"
                            class="flex w-full justify-between px-4 py-2 text-sm text-gray-700" role="menuitem" tabindex="-1" id="menu-0-item-2">
                            <span>Edit channel...</span>
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>


                </div>
              </div>
            </div>
            
            <div th:if="${channel.threads.size() == 0}" class="text-center">
              <img src="https://backend-prod.absurd.design/uploads/ckvtjdc08000114r081x1axyx.jpg" alt="Illustration" class="mx-auto h-80 text-gray-400">
              <h3 class="mt-2 text-sm font-semibold text-gray-900">Every discussion is a thread</h3>
              <p class="mt-1 text-sm text-gray-500">Threads keep discussions on-topic. They can be linked, referenced, and searched for later. It's your Async superpower.</p>
              <div class="mt-6">
                <a th:href="@{/w/{workspaceId}/c/{channelId}/compose(workspaceId=${workspace.id}, channelId=${channel.id})}" type="button" class="inline-flex items-center rounded-md bg-cyan-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-cyan-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">

                  <svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 mr-1.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
                  </svg>
                
                  New thread
                </a>
              </div>
            </div>

            <!-- Show pinned threads first -->

            <div th:if="${channel.threads.size() > 0}" class="mt-8">
              
              <div class="mx-auto max-w-none" th:each="thread : ${channel.threads}" th:if="${thread.pinned == true}">
                <a th:href="@{/w/{workspaceId}/c/{channelId}/t/{threadId}(workspaceId=${workspace.id}, channelId=${channel.id}, threadId=${thread.id})}">
                
                  <div class="overflow-hidden bg-white hover:bg-cyan-50 rounded-lg">
                  <div class="px-4 py-5 sm:px-6">
                    <div class="flex space-x-3">
                      <div class="mx-auto my-auto text-gray-600 w-4">
                        <svg th:if="${thread.isPinned}" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z" />
                        </svg>   
                        <svg th:if="${thread.isClosed}" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 text-cyan-600">
                          <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
                        </svg>  
                                           
                      </div>
                      <div class="flex-shrink-0">
                        <img class="h-10 w-10 rounded-full" th:src="${'https://api.dicebear.com/9.x/initials/svg?seed=' + thread.createdBy.firstName + ' ' + thread.createdBy.lastName}" th:alt="${thread.createdBy.firstName + ' ' + thread.createdBy.lastName}">
                      </div>
                      <div class="min-w-0 flex-1">
                        <div class="flex justify-between">
                          <p class="text-sm font-semibold text-gray-900">
                            <span th:text="${thread.title}"></span>
                          </p>
                          <div>
                            <span class="text-sm text-gray-500" 
                          th:with="lastPost=${thread.posts.empty ? null : thread.posts[thread.posts.size() - 1]}"
                          th:text="${lastPost != null ? #dates.format(lastPost.createdAt, 'MMMM d, hh:mm a') : 'No posts yet'}">Date not available</span>
                        
                          </div>
                          
                        </div>
                        
                        <div class="text-sm text-gray-500 inline-content inline-content line-clamp-2" th:if="${!thread.posts.empty}">
                          <span th:with="lastPost=${thread.posts[thread.posts.size() - 1]}"
                                th:text="${lastPost.createdBy.firstName + ' ' + lastPost.createdBy.lastName + ': '}"></span>
                          <span th:with="lastPost=${thread.posts[thread.posts.size() - 1]}"
                                th:utext="${lastPost.content}"></span>
                        </div>
                        <div class="text-sm text-gray-500" th:if="${thread.posts.empty}">
                          No posts in this thread yet.
                        </div>
                      </div>
                      <div class="flex flex-shrink-0 self-center">
                        <div x-data="Components.menu({ open: false })" x-init="init()" @keydown.escape.stop="open = false; focusButton()" @click.away="onClickAway($event)" class="relative inline-block text-left">  
                        </div>
                      </div>
                    </div>
                    
                  </div>
        
                </div>
          
              
                </a>
              </div>
              
              <div class="mx-auto max-w-none" th:each="thread : ${channel.threads}" th:if="${thread.pinned == false && thread.isClosed == false}">
                <a th:href="@{/w/{workspaceId}/c/{channelId}/t/{threadId}(workspaceId=${workspace.id}, channelId=${channel.id}, threadId=${thread.id})}">
                
                  <div class="overflow-hidden bg-white hover:bg-cyan-50 rounded-lg">
                  <div class="px-4 py-5 sm:px-6">
                    <div class="flex space-x-3">
                      <div class="mx-auto my-auto text-gray-600 w-4">
                        <svg th:if="${thread.isPinned}" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z" />
                        </svg>   
                        <svg th:if="${thread.isClosed}" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 text-cyan-600">
                          <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
                        </svg>                
                      </div>
                      <div class="flex-shrink-0">
                        <img class="h-10 w-10 rounded-full" th:src="${'https://api.dicebear.com/9.x/initials/svg?seed=' + thread.createdBy.firstName + ' ' + thread.createdBy.lastName}" th:alt="${thread.createdBy.firstName + ' ' + thread.createdBy.lastName}">
                      </div>
                      <div class="min-w-0 flex-1">
                        <div class="flex justify-between">
                          <p class="text-sm font-semibold text-gray-900">
                            <span th:text="${thread.title}"></span>
                          </p>
                          <span class="text-sm text-gray-500" 
                          th:with="lastPost=${thread.posts.empty ? null : thread.posts[thread.posts.size() - 1]}"
                          th:text="${lastPost != null ? #dates.format(lastPost.createdAt, 'MMMM d, hh:mm a') : 'No posts yet'}">Date not available</span>
                        </div>
                        
                        <div class="text-sm text-gray-500 inline-content inline-content line-clamp-2" th:if="${!thread.posts.empty}">
                          <span th:with="lastPost=${thread.posts[thread.posts.size() - 1]}"
                                th:text="${lastPost.createdBy.firstName + ' ' + lastPost.createdBy.lastName + ': '}"></span>
                          <span th:with="lastPost=${thread.posts[thread.posts.size() - 1]}"
                                th:utext="${lastPost.content}"></span>
                        </div>
                        <div class="text-sm text-gray-500" th:if="${thread.posts.empty}">
                          No posts in this thread yet.
                        </div>
                      </div>
                      <div class="flex flex-shrink-0 self-center">
                        <div x-data="Components.menu({ open: false })" x-init="init()" @keydown.escape.stop="open = false; focusButton()" @click.away="onClickAway($event)" class="relative inline-block text-left">  
                        </div>
                      </div>
                    </div>
                    
                  </div>
        
                </div>
          
              
                </a>
              </div>

              <div class="mx-auto max-w-none" th:each="thread : ${channel.threads}" th:if="${thread.pinned == false && thread.isClosed == true}">
                <a th:href="@{/w/{workspaceId}/c/{channelId}/t/{threadId}(workspaceId=${workspace.id}, channelId=${channel.id}, threadId=${thread.id})}">
                
                  <div class="overflow-hidden bg-white hover:bg-cyan-50 rounded-lg">
                  <div class="px-4 py-5 sm:px-6">
                    <div class="flex space-x-3">
                      <div class="mx-auto my-auto text-gray-600 w-4">
                        <svg th:if="${thread.isPinned}" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z" />
                        </svg>   
                        <svg th:if="${thread.isClosed}" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 text-cyan-600">
                          <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
                        </svg>                
                      </div>
                      <div class="flex-shrink-0">
                        <img class="h-10 w-10 rounded-full" th:src="${'https://api.dicebear.com/9.x/initials/svg?seed=' + thread.createdBy.firstName + ' ' + thread.createdBy.lastName}" th:alt="${thread.createdBy.firstName + ' ' + thread.createdBy.lastName}">
                      </div>
                      <div class="min-w-0 flex-1">
                        <div class="flex justify-between">
                          <p class="text-sm font-semibold text-gray-900">
                            <span th:text="${thread.title}"></span>
                          </p>
                          <span class="text-sm text-gray-500" 
                          th:with="lastPost=${thread.posts.empty ? null : thread.posts[thread.posts.size() - 1]}"
                          th:text="${lastPost != null ? #dates.format(lastPost.createdAt, 'MMMM d, hh:mm a') : 'No posts yet'}">Date not available</span>
                        </div>
                        
                        <div class="text-sm text-gray-500 inline-content inline-content line-clamp-2" th:if="${!thread.posts.empty}">
                          <span th:with="lastPost=${thread.posts[thread.posts.size() - 1]}"
                                th:text="${lastPost.createdBy.firstName + ' ' + lastPost.createdBy.lastName + ': '}"></span>
                          <span th:with="lastPost=${thread.posts[thread.posts.size() - 1]}"
                                th:utext="${lastPost.content}"></span>
                        </div>
                        <div class="text-sm text-gray-500" th:if="${thread.posts.empty}">
                          No posts in this thread yet.
                        </div>
                      </div>
                      <div class="flex flex-shrink-0 self-center">
                        <div x-data="Components.menu({ open: false })" x-init="init()" @keydown.escape.stop="open = false; focusButton()" @click.away="onClickAway($event)" class="relative inline-block text-left">  
                        </div>
                      </div>
                    </div>
                    
                  </div>
        
                </div>
          
              
                </a>
              </div>
             
              </div>

            
        
            
          </div>
        </main>
        
      </div>
    </body>
</html>

<script>
  function submitForm() {
    this.isSubmitting = true;
    // Simulate form submission (replace with actual form submission logic)
    setTimeout(() => {
      document.querySelector('form').submit();
    }, 1000);
  }
</script>